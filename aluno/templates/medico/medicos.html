{% extends 'base.html' %}

{% block center %}
<h2>Lista de Médicos</h2>

<a href="{% url 'medico_criar' %}" class="btn btn-success mb-3">Novo Cadastro</a>

<form method="get" class="form-inline mb-3">
  <input type="text" name="q" placeholder="Buscar por nome..." value="{{ q }}" class="form-control mr-2" />
  <input type="text" name="especialidade" placeholder="Especialidade" value="{{ especialidade }}" class="form-control mr-2" />
  <select name="ativo" class="form-control mr-2">
    <option value="">Todos</option>
    <option value="1" {% if ativo == '1' %}selected{% endif %}>Ativos</option>
    <option value="0" {% if ativo == '0' %}selected{% endif %}>Inativos</option>
  </select>
  <button type="submit" class="btn btn-primary">Filtrar</button>
</form>

{% if is_paginated %}
  <p>Mostrando {{ page_obj.start_index }}–{{ page_obj.end_index }} de {{ paginator.count }} itens</p>
{% else %}
  <p>Mostrando {{ page_obj|length }} de {{ paginator.count }} itens</p>
{% endif %}

<table class="table table-bordered">
  <thead>
    <tr>
      <th>Foto</th>
      <th>Nome</th>
      <th>E-mail</th>
      <th>Especialidade</th>
      <th>Telefone</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for medico in page_obj.object_list %}
    <tr>
      <td>
        {% if medico.foto %}
          <img src="{{ medico.foto.url }}" alt="Foto do {{ medico.nome }}" width="50" height="50" style="border-radius:50%; object-fit:cover;">
        {% else %}
          <div style="width:50px; height:50px; background-color:#ccc; border-radius:50%; display:flex; align-items:center; justify-content:center;">
            <span style="font-size:12px;">Sem foto</span>
          </div>
        {% endif %}
      </td>
      <td>{{ medico.nome }}</td>
      <td>{{ medico.email }}</td>
      <td>{{ medico.especialidade }}</td>
      <td>{{ medico.telefone }}</td>
      <td>
        <a href="{% url 'medico_editar' id=medico.id %}" class="btn btn-primary btn-sm">Editar</a>
        <a href="{% url 'medico_remover' id=medico.id %}" class="btn btn-danger btn-sm">Remover</a>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="6">Nenhum resultado.</td></tr>
    {% endfor %}
  </tbody>
</table>

<div class="pagination">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}{% if querystring %}&{{ querystring }}{% endif %}" class="btn btn-secondary">Anterior</a>
  {% else %}
    <span class="btn btn-light disabled">Anterior</span>
  {% endif %}

  <span style="margin:0 10px;">Página {{ page_obj.number }} de {{ paginator.num_pages }}</span>

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}{% if querystring %}&{{ querystring }}{% endif %}" class="btn btn-secondary">Próxima</a>
  {% else %}
    <span class="btn btn-light disabled">Próxima</span>
  {% endif %}
</div>
{% endblock %}
